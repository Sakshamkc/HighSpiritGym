@model List<HighSpiritApp.Models.Boxing.BoxingMember>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h4 class="mb-3">Boxing Members</h4>

<!-- Search -->
<form method="get" class="mb-3">
    <div class="input-group">
        <input name="search"
               value="@ViewBag.Search"
               class="form-control"
               placeholder="Search by kid or guardian name" />
        <button class="btn btn-primary">
            <i class="fa-solid fa-search"></i>
        </button>
    </div>
</form>

<div class="card shadow">
    <div class="card-body p-0">

        <table class="table table-hover table-striped mb-0">
            <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Photo</th>
                    <th>Name</th>
                    <th>Joined</th>
                    <th>Guardian Name</th>
                    <th>Contact</th>
                    <th>Price</th>
                    <th>Remarks</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>
                @{
                    int sn = (ViewBag.Page - 1) * 10 + 1;
                }

                @foreach (var b in Model)
                {
                    <tr>
                        <td>@sn</td>
                        <td>
                            @if (b.Photo != null)
                            {
                                <img src="data:image/jpeg;base64,@Convert.ToBase64String(b.Photo)"
                                     class="rounded-circle me-2"
                                     style="width:40px;height:40px;object-fit:cover;" />
                            }
                            else
                            {
                                <i class="fa-solid fa-child fa-lg text-secondary me-2"></i>
                            }
                            @b.Name
                        </td>

                        <td>@b.Name</td>
                        <td>@b.JoinDate?.ToString("dd MMM yyyy")</td>
                        <td>@b.GuardianName</td>
                        <td>
                            <a href="tel:@b.GuardianContact">
                                @b.GuardianContact
                            </a>
                        </td>
                        <td>@b.Price</td>
                        <td title="@b.Remarks">
                            @(string.IsNullOrEmpty(b.Remarks)
                                ? "-"
                                : (b.Remarks.Length > 20
                                ? b.Remarks.Substring(0, 20) + "..."
                                : b.Remarks))
                        </td>
                        <td>
                            <a class="btn btn-sm btn-primary"
                               href="/Boxing/Details/@b.BoxingMemberID">
                                View
                            </a>
                            <a class="btn btn-sm btn-secondary"
                               href="/Boxing/Edit/@b.BoxingMemberID">
                                Edit
                            </a>
                        </td>
                    </tr>
                    sn++;
                }
            </tbody>
        </table>

        <!-- Pagination -->
        <nav class="mt-3">
            <ul class="pagination justify-content-center">
                @for (int i = 1; i <= ViewBag.TotalPages; i++)
                {
                    <li class="page-item @(i == ViewBag.Page ? "active" : "")">
                        <a class="page-link"
                           href="?page=@i&search=@ViewBag.Search">@i</a>
                    </li>
                }
            </ul>
        </nav>

    </div>
</div>
